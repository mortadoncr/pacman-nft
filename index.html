<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<title>Mini Pacman</title>
<style>
  body { background: black; display:flex; justify-content:center; align-items:center; height:100vh; margin:0; }
  #game { 
    display: grid;
    grid-template-columns: repeat(10, 30px);
    grid-template-rows: repeat(10, 30px);
    gap: 2px;
  }
  .cell {
    width: 30px; height: 30px;
    background: black;
    border: 1px solid #222;
  }
  .wall {
    background: #444;
  }
  .pacman {
    background: yellow;
    border-radius: 50%;
  }
  .ghost {
    background: red;
    border-radius: 50%;
  }
  .ghost.blue {
    background: blue;
  }
</style>
</head>
<body>
<div id="game"></div>

<script>
  const width = 10, height = 10;
  const game = document.getElementById('game');
  let grid = [];

  // Carte simple : 1 = mur, 0 = sol
  const map = [
    [1,1,1,1,1,1,1,1,1,1],
    [1,0,0,0,0,0,0,0,0,1],
    [1,0,1,0,1,1,0,1,0,1],
    [1,0,1,0,0,0,0,1,0,1],
    [1,0,1,1,1,1,0,1,0,1],
    [1,0,0,0,0,0,0,1,0,1],
    [1,0,1,1,1,1,1,1,0,1],
    [1,0,0,0,0,0,0,0,0,1],
    [1,0,1,1,1,1,1,1,0,1],
    [1,1,1,1,1,1,1,1,1,1],
  ];

  // Crée la grille visuelle
  function createGrid() {
    game.innerHTML = '';
    grid = [];
    for(let y=0; y<height; y++) {
      for(let x=0; x<width; x++) {
        const cell = document.createElement('div');
        cell.classList.add('cell');
        if(map[y][x] === 1) cell.classList.add('wall');
        game.appendChild(cell);
        grid.push(cell);
      }
    }
  }

  // Convertit coords en index 1D
  function idx(x,y) {
    return y*width + x;
  }

  // Positions
  let pacman = {x:1, y:1};
  let ghosts = [
    {x:8, y:1, color:'red'},
    {x:8, y:7, color:'blue'}
  ];

  // Affiche Pacman et fantômes
  function draw() {
    grid.forEach(c => {
      c.classList.remove('pacman', 'ghost', 'blue');
    });
    grid[idx(pacman.x, pacman.y)].classList.add('pacman');
    ghosts.forEach(g => {
      const c = grid[idx(g.x, g.y)];
      c.classList.add('ghost');
      if(g.color === 'blue') c.classList.add('blue');
    });
  }

  // Déplacement pacman au clavier
  window.addEventListener('keydown', e => {
    let nx = pacman.x;
    let ny = pacman.y;
    if(e.key === 'ArrowUp') ny--;
    else if(e.key === 'ArrowDown') ny++;
    else if(e.key === 'ArrowLeft') nx--;
    else if(e.key === 'ArrowRight') nx++;
    if(map[ny] && map[ny][nx] === 0) {
      pacman.x = nx;
      pacman.y = ny;
    }
    draw();
  });

  // Mouvement fantômes aléatoire
  function moveGhosts() {
    const directions = [
      {x:0,y:-1}, {x:0,y:1}, {x:-1,y:0}, {x:1,y:0}
    ];
    ghosts.forEach(g => {
      const moves = directions.filter(d => {
        const nx = g.x + d.x;
        const ny = g.y + d.y;
        return map[ny] && map[ny][nx] === 0;
      });
      if(moves.length > 0) {
        const m = moves[Math.floor(Math.random()*moves.length)];
        g.x += m.x;
        g.y += m.y;
      }
    });
  }

  // Check collision simple
  function checkCollision() {
    for(const g of ghosts) {
      if(g.x === pacman.x && g.y === pacman.y) {
        alert('Game Over');
        reset();
      }
    }
  }

  function reset() {
    pacman = {x:1, y:1};
    ghosts = [
      {x:8, y:1, color:'red'},
      {x:8, y:7, color:'blue'}
    ];
    draw();
  }

  createGrid();
  draw();
  setInterval(() => {
    moveGhosts();
    draw();
    checkCollision();
  }, 700);
</script>
</body>
</html>
